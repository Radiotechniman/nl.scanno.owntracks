<!doctype html>
<html>
    <head>

    </head>
    <body>

        <h1>Provide MQTT broker setting</h1>
        <p>Name the URL and port (e.g. 192.168.1.40:1883) where the MQTT broker can be found</p>
        <p>If you want to use a public broker, you can try broker.hivemq.com:1883. Leave the user and password fields empty</p>

        <fieldset>
            <legend>MQTT settings</legend>

            <div class="field row">
                <label for="Url">Url</label>
                <input id="url" type="text" value="" />
            </div>
            <div class="field row">
                <label for="User">User</label>
                <input id="user" type="text" value="" />
            </div>
            <div class="field row">
                <label for="Password">Password</label>
                <input id="password" type="password" value="" />
            </div>

        </fieldset>

        <button class="left" onclick="save()">Save changes</button>

        <script type="text/javascript">
        function onHomeyReady(){
           Homey.get('url', function(err, url) {
                  if (err) {
                    console.error(err)
                  } else {
                    document.getElementById('url').value = url
                  }
//                  Homey.ready()
           })
           Homey.get('user', function(err, user) {
                  if (err) {
                    console.error(err)
                  } else {
                    document.getElementById('user').value = user
                  }
//                  Homey.ready()
           })
           Homey.get('password', function(err, password) {
                  if (err) {
                    console.error(err)
                  } else {
                    document.getElementById('password').value = password
                  }
                  Homey.ready()
           })
        }

        function save() {
            Homey.set('url', document.getElementById('url').value)
            Homey.set('user', document.getElementById('user').value)
            Homey.set('password', document.getElementById('password').value)
        }

        </script>

    </body>
</html>
